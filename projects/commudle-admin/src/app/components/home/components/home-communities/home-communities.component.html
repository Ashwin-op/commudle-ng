<nb-card class="home-communities">
  <nb-card-header>
    Communities
  </nb-card-header>
  <nb-card-body class="home-communities-list">
    <nb-list *ngIf="communities.length === 0">
      <nb-list-item *ngFor="let _ of [].constructor(7)">
        <app-skeleton-text [rows]="2"></app-skeleton-text>
      </nb-list-item>
    </nb-list>
    <nb-list *ngIf="communities.length > 0">
      <nb-list-item *ngFor="let community of communities; let i = index" class="clickable">
        <div [routerLink]="['/communities', community.slug]" class="home-community d-flex align-items-center">
          <div class="home-community-image d-flex align-items-center">
            <img alt="{{community.name}}" src="{{community.logo_image.i64}}">
          </div>
          <div class="home-community-details">
            <div class="home-community-name">
              {{community.name | truncatetext:20}}
            </div>
            <div class="home-community-member-count">
              {{community.member_count.toString() + ' Members'}}
            </div>
          </div>
        </div>
        <button (click)="onDialogOpen(community)" *ngIf="community.id" [ngClass]="communityStatus[i] ? 'active' : ''"
                class="home-communities-join" nbButton shape="round">
          {{communityStatus[i] ? 'Joined' : 'Join'}}
        </button>
      </nb-list-item>
    </nb-list>
    <div *ngIf="communities.length > 0" [routerLink]="['/communities']"
         class="home-communities-all text-center clickable">
      <a>Find more</a>
    </div>
  </nb-card-body>
</nb-card>

<ng-template #joinCommunityDialog let-data>
  <nb-card>
    <nb-card-header>Join Community</nb-card-header>
    <nb-card-body>Do you want to know about the community before joining?</nb-card-body>
    <nb-card-footer>
      <button (click)="onDialogClose(data.community)" ghost nbButton>Learn about the community</button>
      <app-membership-toggle (click)="onDialogClose()" [community]="data.community"></app-membership-toggle>
    </nb-card-footer>
  </nb-card>
</ng-template>
